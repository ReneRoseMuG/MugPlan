# FT (01): Kalendertermine verwalten

# Ziel / Zweck

Dieses Feature bildet die **zentrale fachliche Grundlage der Terminplanung**.

Es ermöglicht der Disposition, Termine als zeitliche Planungseinheiten **anzulegen, zu ändern, zu verschieben, zuzuweisen und zu überwachen**, immer im Kontext eines Projekts.

FT (01) ist die **fachliche Quelle der Wahrheit für alle Termindaten**. Alle weiteren Features, die Termine anzeigen, auswerten, überwachen oder ausgeben, leiten ihre Informationen **ausschließlich** aus den hier verwalteten Terminen ab.

## Fachliche Beschreibung

Ein Termin ist eine **zeitliche Planungseinheit** mit einem Startzeitpunkt und einem optionalen Endzeitpunkt. Jeder Termin gehört **immer genau zu einem Projekt**. Über das Projekt ist der Termin **indirekt** einem Kunden zugeordnet. Die Projekt-Termin-Beziehung ist die fachlich relevante und stabile Zuordnung.

Termine sind Mitarbeitern zugeordnet. Die Zuordnungen entstehen automatisch, durch Zuweisung von Mitarbeitern über eine Tour, ein Team oder individuell. Gespeichert wird am Termin jedoch stets die konkrete Mitarbeiterliste, nicht die Vorlage.

Zeitangaben werden technisch als echte Zeitpunkte geführt, damit spätere Anforderungen an „echte Uhrzeiten“ ohne erneute Modellmigration möglich sind. In der UI bleiben Uhrzeiten zunächst optional, weil der aktuelle Arbeitsmodus weiterhin primär tagesbasiert ist.

Ein Termin kann:

- unabhängig von einer Tour existieren,
- null, einen oder mehrere Mitarbeiter zugewiesen bekommen,
- über Teams mit Mitarbeitern belegt werden,
- über die Tourzuweisung mit Mitarbeitern belegt werden,
- Mitarbeiter können nur einmal im Termin existieren, keine Dupletten durch Team- oder Tourzuweisung,
- Mitarbeiter dürfen nur zugewiesen werden, wenn sich dadurch keine Überschneidungen mit anderen Terminen des Mitarbeiters ergeben,
- in verschiedenen Kalender- und Übersichtsansichten dargestellt werden,
- ohne Uhrzeit als Ganztagstermin gelten,
- optional eine Startuhrzeit besitzen, um einen Termin innerhalb eines Tages zeitlich zu verorten.

Termine können auf zwei fachlich gleichwertige Arten entstehen:

- durch Anlegen eines Termins **innerhalb eines Projekts**, oder
- durch Anlegen eines Termins **im Kalender** mit anschließender Projektzuweisung.

Unabhängig vom Einstiegspunkt gilt:

**Ein Termin ist erst fachlich gültig, wenn ihm ein Projekt zugeordnet ist.**

## Regeln & Randbedingungen

**Grundlegende Terminregeln**

- Ein Termin gehört **immer genau zu einem Projekt**.
- Ein Projekt kann **null, einen oder mehrere Termine** besitzen.
- Termine ohne Projektzuordnung sind **nicht zulässig**.
- Termine enthalten **keine eigenen Kunden- oder Projektdatenkopien**.
- Kunden- und Projektinformationen werden stets **referenziert**, nicht gespeichert.

**Zeitliche Regeln**

- Ein Termin besitzt ein Startdatum und optional ein Enddatum.
- Mehrtägige Termine gelten für **alle Tage ihres Zeitraums**.
- Vergangene Termine sind **read-only** und dürfen nicht verändert werden.
- Ein Termin besitzt intern einen Startzeitpunkt und einen Endzeitpunkt.
- Wird keine Uhrzeit erfasst, gilt der Termin als Ganztagstermin.
- Wird eine Startuhrzeit erfasst, wird der Termin als Zeittermin behandelt.
- Wird eine Startuhrzeit erfasst, leitet das System initial eine Standarddauer von einer Stunde ab.

**Mitarbeiterzuweisung**

- Einem Termin können **null, ein oder mehrere Mitarbeiter** zugewiesen werden.
- Es dürfen nur **aktive Mitarbeiter** neuen oder zukünftigen Terminen zugewiesen werden.
- **Harte Regel (blockierend):**
    
    Ein Mitarbeiter darf im Zeitraum eines Termins **nicht zeitlich überschneidend** mehreren Terminen zugewiesen sein.
    
- Wird ein Mitarbeiter vor Durchführung eines Termins ersetzt, darf der Termin **nicht mehr** in der Historie des abgelösten Mitarbeiters erscheinen.

**Zuweisung einer Tour**

- Der Termin übernimmt die Mitarbeiter, die der Tour zugeordnet sind
- Ein Termin ohne Tour wird in einer **Standardfarbe** dargestellt.
- Touren dienen der organisatorischen Gruppierung und visuellen Orientierung.
- Das Wechseln der Tour entfernt die Mitarbeiter der vorherigen Tour vom Termin und fügt die der neuen Tour an
- Das Entfernen der Tour entfernt die Mitarbeiter der Tour vom Termin

**Zuweisung eines Team**

- Team sind **reine Eingabehilfen**.
- Gespeichert wird am Termin **immer die konkrete Mitarbeiterliste**, niemals die Vorlage.
- Änderungen an Teams wirken **nicht rückwirkend**.
- Der Termin übernimmt die Mitarbeiter des Teams

## **Use Cases**

### **UC: Termin anlegen**

**Akteur:** [RO (01): Disponent](https://www.notion.so/RO-01-Disponent-2eada094354e80c1af01d041b1bda7af?pvs=21) 

**Ziel:**

Für ein bestehendes Projekt einen neuen Termin im Kalender anlegen. 

**Vorbedingungen:**

- Projekt existiert.

**Ablauf:**

1. Disponent wählt ein Projekt (z. B. aus der Projektübersicht) oder startet Neuer Termin aus Projekt
2. Disponent erfasst Startdatum und optional Enddatum, sowie optional eine Startuhrzeit
3. Disponent weist dem Termin optional eine Tour zu.
4. Disponent weist dem Termin optional ein Team zu
5. Disponent weist optional Mitarbeiter zu (manuell).
6. System prüft Mitarbeiter-Überschneidungen im Zeitraum. Mitarbeiter dürfen keine überschneidenden Termine haben.
7. System speichert den Termin und zeigt ihn im Kalender an.

**Alternativen:**

- Überschneidung erkannt → System blockiert und zeigt Konflikt.
- Abbruch → Termin wird nicht gespeichert.

**Ergebnis:**

Der Termin ist dem Projekt zugeordnet und im Kalender sichtbar (mit Tourfarbe oder Standardfarbe).

### **UC: Termin bearbeiten**

**Akteur:** [RO (01): Disponent](https://www.notion.so/RO-01-Disponent-2eada094354e80c1af01d041b1bda7af?pvs=21) 

**Ziel:**

Einen bestehenden Termin ändern.

**Vorbedingungen:**

- Termin existiert.

**Ablauf:**

1. Disponent öffnet den Termin.
2. Disponent ändert Zeitraum, Tourzuweisung, Teamzuweisung und/oder Mitarbeiterzuweisung.
3. Disponent ändert optional die Startuhrzeit.
4. System prüft Mitarbeiter-Überschneidungen und vorhandene Mitarbeiter Termine.
5. System speichert die Änderungen.

**Alternativen:**

- Überschneidung → System blockiert und zeigt Konflikt.
- Abbruch → keine Änderung.

**Ergebnis:**

Der Termin ist aktualisiert und korrekt im Kalender dargestellt.

### **UC: Termin verschieben**

**Akteur:** [RO (01): Disponent](https://www.notion.so/RO-01-Disponent-2eada094354e80c1af01d041b1bda7af?pvs=21) 

**Ziel:**

Einen Termin zeitlich verlegen.

**Vorbedingungen:**

- Termin existiert.

**Ablauf:**

1. Disponent wählt den Termin.
2. Disponent ändert Start- und/oder Enddatum oder alternativ er verschiebt den Termin in der Kalenderansicht mit der Maus.
3. Termin verschieben wird tageweise vorgenommen, auch wenn ein Termin eine Startuhrzeit hat. Diese Angabe belibt bei MAus-gesteuerten verschieben unverändert.
4. System prüft Mitarbeiter-Überschneidungen.
5. System speichert den neuen Zeitraum.

**Alternativen:**

- Überschneidung → System blockiert und zeigt Konflikt.

**Ergebnis:**

Der Termin ist im neuen Zeitraum im Kalender sichtbar.

### **UC: Termin löschen**

**Akteur:** [RO (01): Disponent](https://www.notion.so/RO-01-Disponent-2eada094354e80c1af01d041b1bda7af?pvs=21) 

**Ziel:**

Einen Termin aus der Planung entfernen.

**Vorbedingungen:**

- Termin existiert.

**Ablauf:**

1. Disponent wählt den Termin.
2. Disponent bestätigt die Löschung.
3. System löscht den Termin.
4. Die Terminzuordnungen dieses Termins zu den am Termin hängenden Mitarbeitern, müssen entfernt werden.

**Alternativen:**

- Abbruch → Termin bleibt bestehen.

**Ergebnis:**

Der Termin ist gelöscht und nicht mehr im Kalender sichtbar.

### **UC: Tour einem Termin zuweisen**

**Akteur:** [RO (01): Disponent](https://www.notion.so/RO-01-Disponent-2eada094354e80c1af01d041b1bda7af?pvs=21) 

**Ziel:**

Einem bestehenden Termin optional eine Tour zuweisen, um ihn organisatorisch zu gruppieren und farblich darzustellen.

**Vorbedingungen:**

- Termin existiert.
- Mindestens eine Tour existiert.

**Ablauf:**

1. Disponent wählt einen Termin.
2. Disponent weist dem Termin eine Tour zu.
3. Termin übernimmt die Mitarbeiter, die der Tour zugewiesen sind.
4. System prüfe ob es Terminüberscheidungen bei den Terminen der abngehängten Mitarbeiter gibt.
5. System speichert die Tourzuweisung.
6. System aktualisiert die Kalenderdarstellung (Tourfarbe).

**Alternativen:**

- Abbruch → keine Änderung.

**Ergebnis:**

Der Termin ist über die tour_id einer Tour zugeordnet und verwendet deren Farbinformation für die Darstellung.

Die zum Zeitpunkt der Zuweisung der Tour zugeordneten Mitarbeiter werden einmalig an den Termin übernommen.

### **UC: Tourzuweisung eines Termins entfernen**

**Akteur:** [RO (01): Disponent](https://www.notion.so/RO-01-Disponent-2eada094354e80c1af01d041b1bda7af?pvs=21) 

**Ziel:**

Eine bestehende Tourzuweisung von einem Termin entfernen.

**Vorbedingungen:**

- Termin existiert.
- Dem Termin ist eine Tour zugewiesen.

**Ablauf:**

1. Disponent wählt den Termin.
2. Disponent entfernt die Tourzuweisung.
3. System entfernt die Mitarbeiter, die der Tour zugewiesen sind aus diesem Termin.
4. System speichert die Änderung.
5. System stellt den Termin im Kalender in der Standardfarbe dar.

**Alternativen:**

- Abbruch → keine Änderung.

**Ergebnis:**

Der Termin wird neutral dargestellt.

### **UC: Mitarbeiter über Team zuweisen**

**Akteur:** [RO (01): Disponent](https://www.notion.so/RO-01-Disponent-2eada094354e80c1af01d041b1bda7af?pvs=21) 

**Ziel:**

Mehrere Mitarbeiter in einem Schritt einem Termin zuweisen.

**Vorbedingungen:**

- Termin existiert.
- Mindestens eine Team existiert.

**Ablauf:**

1. Disponent wählt einen Termin.
2. Disponent wählt eine Team.
3. System übernimmt alle zugeordneten Mitarbeiter.
4. System prüft die Termine der angehängten Mitarbeiter auf Konflikte.
5. System prüft Mitarbeiter-Überschneidungen.
6. System speichert die Zuweisung.

**Alternativen:**

- Überschneidung → blockieren + Konflikt anzeigen.

**Ergebnis:**

Alle Mitarbeiter der Vorlage sind dem Termin zugewiesen.

### **UC: Mitarbeiter einem Termin zuweisen**

**Akteur:** [RO (01): Disponent](https://www.notion.so/RO-01-Disponent-2eada094354e80c1af01d041b1bda7af?pvs=21) 

**Ziel:**

Einen einzelnen Mitarbeiter gezielt einem bestehenden Termin zuweisen.

**Vorbedingungen:**

- Termin existiert.
- Mitarbeiter existiert und ist aktiv.

**Ablauf:**

1. Disponent wählt einen Termin.
2. Disponent wählt einen einzelnen Mitarbeiter aus.
3. System prüft zeitliche Überschneidungen des Mitarbeiters im Terminzeitraum.
4. System speichert die Zuweisung.

**Alternativen:**

- Überschneidung erkannt → System blockiert und zeigt Konflikt.
- Abbruch → keine Änderung.

**Ergebnis:**

Der ausgewählte Mitarbeiter ist dem Termin zugewiesen.

## **Zusammenfassung (fachlich klar)**